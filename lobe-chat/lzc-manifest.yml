lzc-sdk-version: '0.1'
name: LobeChat 数据库版本
package: cloud.lazycat.app.lobe-chat-database
version: 0.1.0+1.114.6
application:
  routes:
    - /=http://lobe-chat:8080/ # gitlab是services中的名字，.lzcapp是固定后缀，中间的是上面的package字段
  subdomain: lobe-chat
service:
  postgresql:
    image: registry.lazycat.cloud/pgvector:pg17
    binds:
      - '/lzcapp/var/postgresql:/var/lib/postgresql'
    environment:
      - 'POSTGRES_DB=LAZYCAT'
      - 'POSTGRES_PASSWORD=LAZYCAT'
  minio:
    image: minio/minio:RELEASE.2025-04-22T22-12-26Z
    binds:
      - '/lzcapp/var/s3_data:/etc/minio/data'
    environment:
      - 'MINIO_API_CORS_ALLOW_ORIGIN=*'
      - 'MINIO_ROOT_USER=LAZYCAT'
      - 'MINIO_ROOT_PASSWORD=LAZYCAT'
  lobe-chat-database:
    image: lobehub/lobe-chat-database:1.114.6
    environment:
    # 身份验证
      - 'NEXT_AUTH_SSO_PROVIDERS=casdoor'
      - 'NEXT_AUTH_SECRET=NX2kaPE923dt6BL2U8e9oSre5RfoT7hg'
      - 'NEXT_AUTH_SSO_PROVIDERS=generic-oidc'
      - 'NEXTAUTH_URL=${LAZYCAT_AUTH_OIDC_AUTH_URI}'
      - 'AUTH_GENERIC_OIDC_ID=${LAZYCAT_AUTH_OIDC_CLIENT_ID}'
      - 'AUTH_GENERIC_OIDC_SECRET=${LAZYCAT_AUTH_OIDC_CLIENT_SECRET}'
      - 'AUTH_GENERIC_OIDC_ISSUER=${LAZYCAT_AUTH_OIDC_ISSUER_URI}'

      - 'DATABASE_URL=postgresql://postgres:LAZYCAT@postgresql:5432/LAZYCAT'
      - 'S3_BUCKET=${MINIO_LOBE_BUCKET}'
      - 'S3_ENABLE_PATH_STYLE=1'
      - 'S3_ACCESS_KEY=${MINIO_ROOT_USER}'
      - 'S3_ACCESS_KEY_ID=${MINIO_ROOT_USER}'
      - 'S3_SECRET_ACCESS_KEY=${MINIO_ROOT_PASSWORD}'
      - 'LLM_VISION_IMAGE_USE_BASE64=1'
      - 'S3_SET_ACL=0'
      - 'SEARXNG_URL=http://searxng:8080'